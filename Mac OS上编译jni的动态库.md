#Mac OS上编译jni的动态库
JNI是Java Native interface的缩写，是java平台调用本地语言尤其是c和c++设计的。
下面就聊聊在Mac OS上面如何编译JNI的动态库。
##编写java类
```
public class MacJni {

    public native void sayHello();

    static {
        System.loadLibrary("macjni");
    }

    public static void main(String[] args) {
        MacJni macJni = new MacJni();
        macJni.sayHello();

    }
}
```
首先定义了一个MacJni的类，在main中调用定义的native的方式sayHello。
在static中加载native的类库macjni,注意在linux上面动态库的命名是.so文件，在mac上面的命名是.jnilib文件,类库的名字需要加上lib,也就是在Mac os上面动态库的名称应该是*libmacjni.jnilib*

##生成.java
通过命令生成.class文件:
>javac MacJni.java

生成了一个MacJni.class的文件。
##生成.h文件
通过命令生成.h文件:
>javah MacJni
生成了一个MacJni.h的文件。文件内容:
```
* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class MacJni */

#ifndef _Included_MacJni
#define _Included_MacJni
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     MacJni
 * Method:    sayHello
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_MacJni_sayHello
  (JNIEnv *, jobject);

#ifdef __cplusplus
}
#endif
#endif
```
文件定义了一个方法Java_MacJni_sayHello,jni在c中定义的规则是Java_包名_类名_方法名。

##编写.c文件
根据定义.h方法，需要生成一个.c文件*MacJni.c*
```
#include <stdio.h>
#include "MacJni.h"

JNIEXPORT void Java_MacJni_sayHello(JNIEnv * env, jobject obj){
    printf("hello from jni");
}
```
这个方法很简单就是打印一句话。
##编译.c
在MacJni.h中有一句话*#include <jni.h>*jni.h这个文件是jdk中的头文件，我们在编译.c的时候需要指定jni.h的所在。在Mac OX中他所在的问题是`/System/Library/Frameworks/JavaVM.framework/Headers`。
>gcc -I/System/Library/Frameworks/JavaVM.framework/Headers -c MacJni.c

得到一个新的文件MacJni.o,需要把.o文件打包成动态库。
##打包动态库
>gcc -dynamiclib -o libmacjni.jnilib MacJni.o

把.o文件打包成了`libmacjni.jnilib`。就可以通过java调用c了。

>java MacJni
```
hello from jni
```

项目地址：https://github.com/jjz/jni

